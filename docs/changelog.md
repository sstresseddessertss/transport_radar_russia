# Changelog

## [2026-02-12] - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Enhancement)

### –î–æ–±–∞–≤–ª–µ–Ω–æ

#### Backend
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `web-push` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Web Push API
- –î–æ–±–∞–≤–ª–µ–Ω—ã VAPID –∫–ª—é—á–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω endpoint `GET /api/vapid-public-key` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –∫–ª–∏–µ–Ω—Ç–æ–º
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω endpoint `POST /api/stops/:stopId/subscribe` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω endpoint `POST /api/stops/:stopId/unsubscribe` –¥–ª—è –æ—Ç–ø–∏—Å–∫–∏ –æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∫ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (retry) –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)**
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (cooldown 5 –º–∏–Ω—É—Ç)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ (—Å—Ç–∞—Ç—É—Å 410/404)
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è subscription –æ–±—ä–µ–∫—Ç–æ–≤ (endpoint, keys, URL format)**
- **Rate limiting –¥–ª—è subscribe/unsubscribe endpoints (5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç–∞)**
- **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (‚úÖ, ‚ùå, ‚ûï, ‚ûñ, üóëÔ∏è)**
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π: –ª–∏–º–∏—Ç 100 –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫—É**

#### Frontend
- –°–æ–∑–¥–∞–Ω Service Worker (`/public/sw.js`) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ö–Ω–æ–ø–∫–∞ "–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" / "–û—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" —Å –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π —Å—Ç–∞—Ç—É—Å–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Push Manager API
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é (—Ñ–æ–∫—É—Å –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –û–∫—Ä—É–∂–µ–Ω–∏–µ
- **–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env.example` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
  - `PORT` - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
  - `PUBLIC_VAPID_KEY` / `PRIVATE_VAPID_KEY` - VAPID –∫–ª—é—á–∏
  - `NOTIFICATION_COOLDOWN` - –≤—Ä–µ–º—è cooldown
  - `RATE_LIMIT_WINDOW` / `MAX_IMPORTS_PER_WINDOW` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ rate limiting

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°–æ–∑–¥–∞–Ω `test-push.js` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∂–∏–º–æ–≤
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VAPID –∫–ª—é—á–µ–π
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–°–æ–∑–¥–∞–Ω `test-push-notifications.js` - unit —Ç–µ—Å—Ç—ã –¥–ª—è push-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**
  - –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫
  - –¢–µ—Å—Ç—ã rate limiting
  - –¢–µ—Å—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã payload
  - –¢–µ—Å—Ç—ã –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫
  - –¢–µ—Å—Ç—ã cooldown –º–µ—Ö–∞–Ω–∏–∑–º–∞
- **–î–æ–±–∞–≤–ª–µ–Ω—ã npm scripts:**
  - `npm test` - –∑–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤
  - `npm run test:push` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é push
  - `npm run generate-keys` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è VAPID –∫–ª—é—á–µ–π

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å—Ö–µ–º–∞ –¥–ª—è –±—É–¥—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
- **–°–æ–∑–¥–∞–Ω `schema.sql` —Å SQL —Å—Ö–µ–º–æ–π –¥–ª—è PostgreSQL**
  - –¢–∞–±–ª–∏—Ü–∞ `push_subscriptions` —Å –ø–æ–ª—è–º–∏:
    - `id`, `stop_id`, `subscription_json`, `notification_minutes`
    - `user_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –º—É–ª—å—Ç–∏—é–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏)
    - `created_at`, `last_active`, `is_active`
  - –¢–∞–±–ª–∏—Ü–∞ `notification_history` –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
  - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
  - –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç:
  - –ù–æ–º–µ—Ä –º–∞—Ä—à—Ä—É—Ç–∞ —Ç—Ä–∞–º–≤–∞—è
  - –í—Ä–µ–º—è –¥–æ –ø—Ä–∏–±—ã—Ç–∏—è –≤ –º–∏–Ω—É—Ç–∞—Ö
  - –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–≥–¥–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3 –º–∏–Ω—É—Ç—ã)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –¥–∞–∂–µ –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö —Å–µ—Ç–∏ (5xx) –∏ rate limiting (429)**
- **Graceful degradation - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ push –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç**

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª `docs/tasks.yaml` —Å –æ—Ç–º–µ—Ç–∫–æ–π –∑–∞–¥–∞—á–∏ #103 –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π
- –û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª `docs/changelog.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –§–∞–π–ª `docs/decisions.md` —Å–æ–¥–µ—Ä–∂–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º
- **–û–±–Ω–æ–≤–ª–µ–Ω `README.md` —Å:**
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
  - –†–∞–∑–¥–µ–ª–æ–º –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
  - –û–ø–∏—Å–∞–Ω–∏–µ–º API endpoints
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –ü—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç Web Push API
- VAPID (Voluntary Application Server Identification) –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞
- Service Worker —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–æ–±—ã—Ç–∏–π `push` –∏ `notificationclick`
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ (in-memory Map)
- **Retry –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (1 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏)**
- **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: retryable (5xx) vs non-retryable (4xx) –æ—à–∏–±–∫–∏**
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏: Chrome, Firefox, Edge

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- VAPID –∫–ª—é—á–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —á–µ—Ä–µ–∑ cooldown –º–µ—Ö–∞–Ω–∏–∑–º (5 –º–∏–Ω—É—Ç)
- **Rate limiting –Ω–∞ subscribe/unsubscribe endpoints**
- **–°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è: –º–∞–∫—Å–∏–º—É–º 100 –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫—É**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ (410, 404 —Å—Ç–∞—Ç—É—Å—ã)
- **–û—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ (–ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å > 24 —á–∞—Å–∞)**
